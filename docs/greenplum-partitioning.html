<!--
Copyright (C) 2019-Present Pivotal Software, Inc. All rights reserved.
This program and the accompanying materials are made available under the terms of the under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License. You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and
limitations under the License.
-->

<!DOCTYPE html>
<html class="sl-root decks export offline loaded">
<head>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Greenplum Data Partititioning</title>


    <link rel="stylesheet" type="text/css" href="lib/offline-v2.css">
    <link rel="stylesheet" type="text/css" href="lib/gp-workshop.css">
    <link rel="stylesheet" type="text/css" href="lib/gp-workshop-grid.css">

</head>
<body class="reveal-viewport theme-font-montserrat theme-color-white-blue">
<div class="reveal">
    <div class="slides">
        <section class="title-slide" data-id="title-slide">
            <div class="grid-page">
                <div class="full-page" id="title-slide">
                    <div><h1>Petabyte Scale Data Warehousing with Greenplum</h1></div>
                    <h2 class="subtitle">Partitioning</h2>
                </div>
            </div>
        </section>
        <section class="agenda-slide" data-id="data-partitioning-slide-2">
            <div class="grid-page">
                <div class="header">
                    <div></div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="content-first-third">
                    <h1>Agenda</h1>
                </div>
                <div class="content-third-third">
                    <ul>
                        <li>Why partition a table?</li>
                        <li>Difference between data <em><strong>distribution</strong></em>
                            and data <strong><em>partitioning</em></strong></li>
                        <li>Partitioning strategies</li>
                        <li>Loading partitioned tables</li>
                        <li>Partitioning summary</li>
                    </ul>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-3">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Partitioning in Greenplum</h2>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="full-page">
                    <ul>
                        <li>A mechanism for use in physical database design</li>
                        <li>Increase the available options for improving the performance of a certain class of queries</li>
                        <li>Propagate data to the child tables</li>
                        <li>GP partitioning DDL is different than PostgreSQL partitioning
                            <ul>
                                <li>
                                    <a href="https://www.postgresql.org/docs/9.1/static/ddl-partitioning.html" target="_blank">
                                        https://www.postgresql.org/docs/9.1/static/ddl-partitioning.html
                                    </a>
                                </li>
                                <li>
                                    <a href="https://www.postgresql.org/docs/10/static/ddl-partitioning.html" target="_blank">
                                        https://www.postgresql.org/docs/10/static/ddl-partitioning.html
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-4">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Why Partition a Table?</h2>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="full-page">
                    <ul>
                        <li>To more efficiently query a subset of a large data set
                            <ul>
                                <li>decrease query times by avoiding full table scans</li>
                            </ul>
                        </li>
                        <li>To avoid the overhead and maintenance costs of an index</li>
                        <li>To handle increasing volumes of data that the average query doesn't need</li>
                        <li>Allow near instantaneous dropping of older data and simple addition of newer data</li>
                        <li>Supports a rolling <em>N</em> periods methodology for archiving data</li>
                    </ul>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-5">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Why Partition a Table?</h2>
                        <h3>A little more detail</h3>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="content-top-half">
                    <ul>
                        <li>Partition elimination/pruning
                            <ul>
                                <li>Only scan relevant data</li>
                            </ul>
                        </li>
                        <li>Partition types are RANGE and LIST</li>
                        <li>Distribution allocates rows to segments. In each segment, partitioning separates the rows into
                            distinct files.
                            <ul>
                                <li>Distribution + Partitioning = "Plaiding" of data</li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <div class="content-bottom-half">
                    <div class="boxshadow-best-practice">
                        <p>Best Practice: Do not use multi-level partitioning</p>
                        <ul>
                            <li>Sub-partitions often have little to no data</li>
                            <li>Most queries cannot take advantage of partition pruning</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-6">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Partitioning Methods</h2>
                        <h3>RANGE and LIST</h3>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="content-left-half"
                     style="background-color: var(--pres-orange-opaque); margin-top:100px; border-radius: 20px;">
                    <figure style="z-index: 50; margin-top: 30px">
                        <img style="" alt="disk-blue" src="images/disk-blue.png">
                        <p class="position-text" style="color: var(--pres-orange); margin: -55px 10px;">JAN 2011</p>
                    </figure>
                    <figure style="z-index: 40; margin-top: 30px">
                        <img style="" alt="disk-blue" src="images/disk-blue.png">
                        <p class="position-text" style="color: var(--pres-orange); margin: -55px 10px;">FEB 2011</p>
                    </figure>
                    <figure style="z-index: 30; margin-top: 30px">
                        <img style="" alt="disk-blue" src="images/disk-blue.png">
                        <p class="position-text" style="color: var(--pres-orange); margin: -55px 10px;">MAR 2011</p>
                    </figure>
                    <figure style="z-index: 20; margin-top: 30px">
                        <img style="" alt="disk-blue" src="images/disk-blue.png">
                        <p class="position-text" style="color: var(--pres-orange); margin: -55px 10px;">APR 2011</p>
                    </figure>
                    <div style="z-index: 50; color: var(--pres-blue); font-size: 200%; margin-top: 60px;">
                        <p>RANGE</p>
                    </div>
                </div>
                <div class="content-right-half"
                     style="background-color: var(--pres-blue-opaque); margin-top:100px; border-radius: 20px;">
                    <figure style="z-index: 50; margin-top: 30px;">
                        <img alt="disk-orange" src="images/disk-orange.png">
                        <p class="position-text" style="color: var(--pres-blue); margin: -55px 10px;">EMEA</p>
                    </figure>
                    <figure style="z-index: 40; margin-top: 30px">
                        <img alt="disk-orange" src="images/disk-orange.png">
                        <p class="position-text" style="color: var(--pres-blue); margin: -55px 10px;">APAC</p>
                    </figure>
                    <figure style="z-index: 30; margin-top: 30px">
                        <img alt="disk-orange" src="images/disk-orange.png">
                        <p class="position-text" style="color: var(--pres-blue); margin: -55px 10px;">AMER</p>
                    </figure>
                    <figure style="z-index: 20; margin-top: 30px">
                        <img alt="disk-orange" src="images/disk-orange.png">
                        <p class="position-text" style="color: var(--pres-blue); margin: -55px 10px;">AFRI</p>
                    </figure>
                    <div style="z-index: 50; font-size: 200%; color: var(--pres-orange); margin-top: 60px;">
                        <p>LIST</p>
                    </div>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-7">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>When do you partition?</h2>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>

                <div class="content-top-half" style="align-items: flex-start">
                    <div style="background-color: #ddd; margin: 5px; border-radius: 20px;">
                        <p style="color: var(--pivotal-green);">Large fact table</p>
                        <img style="width: 50%" alt="table-ddl" src="images/table-ddl.png">
                    </div>
                    <div style="background-color: #ddd; margin: 5px; border-radius: 20px;">
                        <p style="color: var(--pivotal-green);">Maintaining rolling data</p>
                        <img style="width: 100%" alt="rolling-data" src="images/rolling-data.png">
                    </div>
                </div>
                <div class="content-bottom-half" style="align-items: flex-start">
                    <div style="padding: 0px 3px; background-color: #ddd; margin: 5px; border-radius: 20px;">
                        <p style="color: var(--pivotal-green);">Data divides evenly</p>
                        <img style="height: 80%" alt="balanced-names-data" src="images/balanced-names.png">
                    </div>
                    <div style="padding: 0px 3px; background-color: #ddd; margin: 5px; border-radius: 20px;">
                        <p style="color: var(--pivotal-green)">Performance issues</p>
                        <img style="height: 80%" alt="performance-chart" src="images/performance-chart.png">
                    </div>
                    <div style="padding: 0px 3px; background-color: #ddd; margin: 5px; border-radius: 20px;">
                        <p style="color: var(--pivotal-green);">Identifiable access patterns</p>
                        <img style="height: 80%" alt="3x3-grid" src="images/3x3-grid.png">
                    </div>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-8">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Historical Data Maintenance</h2>
                        <h3>Partition Management</h3>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="full-page">
                    <figure>
                        <img style="width: 90%" alt="rolling-data" src="images/rolling-data-large.png">
                        <div class="position-text">
                            <p style="width: 4em; left: 90px; top: 35px; color: white; font-size: 80%;">Previous Month</p>
                        </div>
                        <div class="position-text">
                            <p style="width: 4em; right: 65px; top: 20px;background-color: white; ">Deep History</p>
                        </div>
                        <div class="position-text" style="z-index: 17; background-color: transparent; color: yellow;">
                            <p style="width: 5em; left: 370px; top: 175px;">Rolling 13 months</p>
                        </div>
                    </figure>
                </div>
            </div>
        </section>
        <section class="stack" data-id="data-partitioning-9-and-10">
            <section data-id="data-partitioning-slide-9">
                <div class="grid-page">
                    <div class="header">
                        <div>
                            <h2>Partitioned Table - DATE RANGE</h2>
                            <h3>Naming each partition</h3>
                        </div>
                        <div class="logo-image"><img alt="" src=""></div>
                    </div>
                    <div class="full-page notranslate" data-highlight-theme="solarized-light" data-code-frame="none"
                         style="margin-top: 40px; font-size: 90%; border: none; ">
                        <pre><code data-line-numbers="7-13">CREATE TABLE sales(
    id int,
    sales_date date,
    amt decimal(10,2)
)
DISTRIBUTED BY (id)
PARTITION BY RANGE (sales_date)
( PARTITION Jan18 START (date '2018-01-01') INCLUSIVE ,
  PARTITION Feb18 START (date '2018-02-01') INCLUSIVE ,
  PARTITION Mar18 START (date '2018-03-01') INCLUSIVE ,
  …
  PARTITION Dec18 START (date '2018-12-01') INCLUSIVE
  END (date '2019-01-01') EXCLUSIVE );</code></pre>
                    </div>
                </div>
            </section>
            <section data-id="data-paritioning-slide-10" data-transition="concave">
                <div class="grid-page">
                    <div class="header">
                        <div>
                            <h2>Partitioned Table - DATE RANGE</h2>
                            <h3>Auto-naming with INTERVAL</h3>
                        </div>
                        <div class="logo-image"><img alt="" src=""></div>
                    </div>
                    <div class="full-page notranslate" data-highlight-theme="solarized-light"
                         data-code-frame="none"
                         style="margin-top: 40px; font-size: 100%; border: none;">
                        <pre><code data-line-numbers="7-13">CREATE TABLE sales(
    id int,
    sales_date date,
    amt decimal(10,2)
)
DISTRIBUTED BY (id)
PARTITION BY RANGE (sales_date)
( PARTITION pre    END   ('2000-01-01'::date),
  PARTITION yearly START ('2000-01-01'::date)
                   END   ('2020-01-01')
                   EVERY ('1 year'::INTERVAL),
  PARTITION post   START ('2020-01-01'::date));</code></pre>
                    </div>
                </div>
            </section>
        </section>
        <section data-id="data-partitioning-slide-11">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Partition Table - NUMERIC RANGE</h2>
                        <h3>Auto-naming and DEFAULT PARTITION</h3>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="content-first-third" style="font-size: 80%; text-align: left; justify-content: space-around;">
                    <div class="sl-block-content fragment" style=";" data-fragment-index="0">
                        <p>How many partitions will be created on each segment?</p>
                    </div>
                    <div class="sl-block-content fragment" data-placeholder-tag="p" data-placeholder-text="Text"
                         style="z-index: 16;" data-fragment-index="1">
                        <p>Default Partition:</p>

                        <p>Good or bad idea?</p>
                    </div>
                </div>
                <div class="content-two-third">
                    <div class="notranslate" data-highlight-theme="solarized-light" data-code-frame="none"
                         style="margin-top: 40px; font-size: 100%; border: none;">
                    <pre><code data-line-numbers="9-11|12" data-fragment-index="1">CREATE TABLE ranking(
    id     int,
    rank   int,
    yr     int,
    gender char(1)
)
DISTRIBUTED BY (id)
PARTITION BY RANGE (yr)
( START (2011)
  END   (2021)
  EVERY 1,
  DEFAULT PARTITION extra );</code></pre>
                    </div>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-12">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Partition Table - LIST</h2>
                        <h3>LIST Example with DEFAULT PARTITION</h3>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="full-page">
                    <div class="notranslate" data-highlight-theme="solarized-light" data-code-frame="none"
                         style="margin: 40px 0px; font-size: 85%; border: none;">
                    <pre><code data-fragment-index="0" data-line-numbers="8-13">CREATE TABLE widgits_staging (
    id int,
    w_name varchar,
    ...,
    state char(2)
)
DISTRIBUTED BY (id)
PARTITION BY LIST (state)
( PARTITION NE   VALUES ('ME','NH','VT','MA','RI','CT'),
  PARTITION MidA VALUES ('NY','NJ','PA','DE','MD','DC'),
   ...
  PARTITION West VALUES ('CA','OR','WA','AK','HI'),
  DEFAULT PARTITION);</code></pre>
                    </div>
                    <p>Default Partition: Might be a good idea here. Why?</p>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-13">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Partitioning an Existing Table</h2>
                        <h3>How is it done?</h3>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="content-top-half" style="align-items: flex-start; justify-content: space-around">
                    <div class="notranslate fragment boxshadow" data-highlight-theme="solarized-light"
                         data-code-frame="none" style="font-size: 70%; " data-fragment-index="0">
                    <pre><code>orders TABLE:

order_id    int,
order_date  date,
order_amt   numeric(8,2),
...</code></pre>
                    </div>
                    <div class="notranslate fragment boxshadow" data-highlight-theme="solarized-light"
                         data-code-frame="none" style="font-size: 70%; " data-fragment-index="1">
                        <pre><code>CREATE TABLE orders_partitioned (
    LIKE orders
)
DISTRIBUTED BY (order_num)
PARTITION BY RANGE (order_date)
( START ('01/01/2000'::date)
  END   ('12/31/2025'::date) INCLUSIVE
  EVERY 1 month
);
</code></pre>
                    </div>
                </div>
                <div class="content-bottom-half">
                    <div class="notranslate fragment boxshadow" data-highlight-theme="obsidian"
                         data-code-frame="none" style="font-size: 90%;" data-fragment-index="2">
                    <pre><code>INSERT INTO orders_partitioned SELECT * FROM orders;

ALTER TABLE orders RENAME to orders_old;
ALTER TABLE orders_partitioned RENAME to orders;

/* verify data transfer and drop orders_old table */

GRANT ... TO orders;
...</code></pre>
                    </div>
                </div>
            </div>
        </section>
        <section data-id="data-paritioning-slide-14">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Partition Maintenance</h2>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="full-page" style="align-items: flex-start;">
                    <div>
                        <ul>
                            <li>Add, Rename, Truncate, Remove</li>
                            <li>Exchange</li>
                        </ul>
                    </div>
                    <div class="sl-block-content notranslate" data-highlight-theme="github-gist" data-code-frame="none"
                         style="font-size: 70%;">
                    <pre><code data-line-numbers="6-7">/* Table 'sales_cm' contains sales data for the current month */
/* At the end of the month, add it to sales_history table */
ALTER TABLE sales_cm RENAME to jan18;
CREATE TABLE sales_cm (like sales_history) DISTRIBUTED BY ...;

ALTER TABLE sales_history EXCHANGE PARTITION
            FOR ('2018-01-01') WITH TABLE jan18;</code></pre>
                    </div>
                    <div>
                        <ul>
                            <li>Split existing partition</li>
                        </ul>
                    </div>
                    <div class="sl-block-content notranslate" data-highlight-theme="github-gist" data-code-frame="none"
                         style="font-size: 70%;">
                    <pre><code data-line-numbers="">ALTER TABLE sales_history SPLIT PARTITION
            FOR ('2018-01-01') AT ('2018-01-16')
            INTO (PARTITION jan181to15, PARTITION jan1816to31);</code></pre>
                    </div>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-15">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Partition Table Details</h2>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="content-top-half" style="align-items: flex-start;">
                    <div class="sl-block-content notranslate" data-highlight-theme="github-gist" data-code-frame="none"
                         style="z-index: 13; font-size: 50%; border: 1px solid black; ">
                        <pre><code data-line-numbers="1,10-12,15">\d+ rankings
                    Table "public.rankings"
 Column |     Type     | Modifiers | Storage  | Description
--------+--------------+-----------+----------+-------------
 id     | integer      |           | plain    |
 rank   | integer      |           | plain    |
 year   | integer      |           | plain    |
 gender | character(1) |           | extended |
 count  | integer      |           | plain    |
Child tables: rankings_1_prt_boys,
              rankings_1_prt_girls,
              rankings_1_prt_other
Has OIDs: no
Distributed by: (id)
Partition by: (gender)</code></pre>
                    </div>
                    <div style="z-index: 15; width: 6em; font-size: 80%; border: 1px solid black;">
                        <p>Parent-child details</p>
                    </div>
                </div>
                <div class="content-bottom-half" style="align-items: flex-start;">
                    <div style="z-index: 15; width: 12em; font-size: 80%; border: 1px solid black;">
                        <p>
                            Further details from <em><strong>pg_partitions</strong></em> and
                            <em><strong>pg_partition_columns</strong></em> catalog views
                        </p>
                    </div>
                    <div class="sl-block-content notranslate" data-highlight-theme="solarized-light" data-code-frame="none"
                         style="z-index: 14; font-size: 43%; border: 1px solid black;">
                        <pre><code data-line-numbers="3,7-9,12,15">select partitiontablename as "Table", partitionboundary as "Boundaries",
       partitiontype as "PartType", partitionlistvalues as "PartValues"
from pg_partitions where tablename = 'rankings';

        Table         |         Boundaries          | PartType |    PartValues
----------------------+-----------------------------+----------+-------------------
 rankings_1_prt_boys  | PARTITION boys VALUES('M')  | list     | 'M'::character(1)
 rankings_1_prt_girls | PARTITION girls VALUES('F') | list     | 'F'::character(1)
 rankings_1_prt_other | DEFAULT PARTITION other     | list     |
(3 rows)

select * from pg_partition_columns where tablename = 'rankings';
 schemaname | tablename | columnname | partitionlevel | position_in_partition_key
------------+-----------+------------+----------------+---------------------------
 public     | rankings  | gender     |              0 |                         1
(1 row)</code></pre>
                    </div>
                </div>
            </div>
        </section>
        <section data-id="data-paritioning-slide-16">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Partition Table Loading</h2>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="full-page" style="margin-top: 40px; ">
                    <ul>
                        <li>Top level, parent tables are empty</li>
                        <li>Data is loaded into child partitions</li>
                        <li>COPY or INSERT automatically load data to the correct partition</li>
                        <li>Load a staging table and swap the table in place of an existing partition</li>
                    </ul>
                </div>
            </div>
        </section>
        <section data-id="data-partitioning-slide-17">
            <div class="grid-page">
                <div class="header">
                    <div>
                        <h2>Partition Table Summary</h2>
                    </div>
                    <div class="logo-image"><img alt="" src=""></div>
                </div>
                <div class="full-page">
                    <ul>
                        <li style="color: red; font-weight: bold">Never distribute and partition on the same column!</li>
                        <li>Do not use multi-level partitioning (sub-partitions) unless absolutely necessary</li>
                        <li>Use partitioning on large tables to improve performance
                            <ul>
                                <li>Used in addition to, not in place of, distribution</li>
                            </ul>
                        </li>
                        <li>Use if the table can be divided into roughly equal parts based on the partitioning key
                            <ul>
                                <li>RANGE partitioning on DATE</li>
                                <li>No overlapping ranges or duplicate values</li>
                            </ul>
                        </li>
                        <li>Partitioning benefits filtering (WHERE clause)</li>
                        <li>Avoid DEFAULT PARTITION if possible</li>
                    </ul>
                </div>
            </div>
        </section>
        <section data-background-color=var(--pivotal-green)
                 class="last-slide" data-menu-title="End">
            <div class="grid-page">
                <div class="full-page">
                    <img alt="Greenplum Database" src="images/logos/logo-gp-horizontal-ondark.png">
                </div>
            </div>
        </section>
    </div>
</div>

<script>
    var SLConfig = {
        "deck": {
            "id": 1624472,
            "slug": "gp-data-partitioning",
            "title": "Greenplum Data Partitioning",
            "description": "",
            "width": 960,
            "height": 720,
            "visibility": "self",
            "published_at": null,
            "sanitize_messages": null,
            "thumbnail_url": "https://s3.amazonaws.com/media-p.slid.es/thumbnails/5c38dbb3bbba2e31c3c1b928cb6830d7/thumb.jpg?1571164864",
            "view_count": 0,
            "user": {
                "id": 1134143,
                "username": "csylvester",
                "name": "Craig Sylvester",
                "description": "Pivotal Data Engineer - Federal Division",
                "thumbnail_url": "https://www.gravatar.com/avatar/d2436491e8c9292c895eebad673e3837?s=140\u0026d=https%3A%2F%2Fstatic.slid.es%2Fimages%2Fdefault-profile-picture.png",
                "paid": true,
                "pro": true,
                "lite": false,
                "team_id": null,
                "settings": {
                    "id": 3868303,
                    "present_controls": true,
                    "present_upsizing": true,
                    "present_pointer": false,
                    "present_notes": true,
                    "default_deck_tag_id": null
                }
            },
            "background_transition": "slide",
            "transition": "slide",
            "theme_id": null,
            "theme_font": "montserrat",
            "theme_color": "white-blue",
            "auto_slide_interval": 0,
            "comments_enabled": true,
            "forking_enabled": false,
            "rolling_links": false,
            "center": false,
            "shuffle": false,
            "should_loop": false,
            "share_notes": false,
            "slide_number": false,
            "slide_count": 19,
            "rtl": false,
            "version": 2,
            "collaborative": false,
            "deck_user_editor_limit": 3,
            "data_updated_at": 1571338814509,
            "font_typekit": null,
            "font_google": null,
            "time_limit": null,
            "upsizing_enabled": true,
            "notes": {
                "data-partitioning-slide-3": "Table partitioning is used to logically divide large tables to improve query performance and facilitate data warehouse maintenance tasks.\nAll structure of the parent table propagates to its children through table inheritance.\nIt is important to keep in mind that parent tables contain no data; all data is stored at the child table level.\nIf you create an index on the table, you will be implicitly creating an index on each of the child tables (the partitions).\nIt is also possible to create an index on the individual partitions.",
                "data-partitioning-slide-4": "While Greenplum is not afraid of full table scans, it is a good idea to partition your table to help Greenplum process the table as efficiently as possible.\nHowever, your business rules should dictate if and how you partition tables.\n\nThe following are some of the reasons for considering table partition as part of the design:\n- Provide more efficiency in querying against a subset of large volumes of transactional detail data as well as to manage this data more effectively. Businesses have recognized the analytic value of detailed transactions and are storing larger and larger volumes of this data.\n- Increase query efficiency by avoiding full table scans.\n- Without the overhead and maintenance costs of an index for date.\n- As the retention volume of detailed transactions increases, the percent of transactions that the “average” query requires for execution decreases.\n- Allow the instantaneous dropping of old data and the simple addition of newer data that may be queried more often. One of the practical uses of partitioned tables is partition swapping or partition exchanging. This practice allows you to load data to a table and replace an existing table with the same data plus the updated information with little impact to the original table.\n- Support a rolling n periods methodology for transactional data. \n\nYou can have default partitions that act as a catchall. This allows you to insert rows without having to worry about a partition. Later, you can alter the table to split the partition with the values that you want to go to the partitioned table.",
                "data-partitioning-slide-5": "Table partitioning may be used to improve query performance by scanning only the relevant data needed to satisfy a given query. Table partitioning does not affect the physical distribution of data. GP supports both range partitioning or list partitioning.  Range partitioning partitions the data based on a numerical range, for example by date, while list partitioning partitions the data based on a list of values, for example location (store, city, state, region). Partitioning using a combination of range partitioning and list partitioning is also supported.  Table partitioning is implemented using table inheritance and constraints. Check constraints limit the data a table can contain based on some defining criteria. These constraints are also used at runtime to determine which child tables to scan in order to satisfy a given query.",
                "data-partitioning-slide-6": "Greenplum Database supports:\n- Range partitioning, where the data used for partitioning is based on a numerical range, such as date or price.\n- List partitioning, where data used for partitioning is based on a list of values, such as a region.\n- A combination of range and list partitioning.\n",
                "data-partitioning-slide-7": "There are several reasons why you would partition your data:\n- Large fact table – Large fact tables are good candidates for table partitioning. If you have billions of rows in a table, you will see performance benefits from breaking that data up into smaller chunks. For smaller tables, avoid partitioning.\n- Unsatisfactory performance – As with any performance tuning initiative, a table should be partitioned only if queries against that table are producing slower response times than desired.\n- Identifiable access patterns – Examine the WHERE clauses of your query workload and look for table columns that are consistently used to access data. For example, if most of your queries look up records by date, then date range based partitioning design might be beneficial.\n- Maintaining rolling data – as discussed earlier, partitioning provides great ILM benefits.\n- Dividing data into equal parts – Choose a partitioning criteria that will divide your data as evenly as possible.  For example, by dividing a large table into 10 partitions of equal size, you should see a 10x speedup for queries having predicates which restrict them to scanning a single partition.",
                "data-partitioning-slide-8": "Let’s begin by considering how table partitioning, combined with a couple of other GPDB storage features, provides a powerful Information Lifecycle Management, or “ILM”, solution.  This example shows a large, partitioned, fact table, tracking transactions back to January 2000.  The current month is “live”, and its data is stored in a row-oriented partition, which is defined on a tablespace which links to an SSD-based filespace.  Queries against this partition are extremely responsive, and may include INSERT, UPDATE, and DELETE, in addition to SELECT.  The previous month’s data, along with data going back on year, is housed within Append-Optimized, columnar partitions, defined within a tablespace tied to SAS disks.  This portion of the data is optimized for the type of reports the organization needs to run against data for the past year.  Older, “deep history” data, is stored on an adjacent Hadoop cluster, within a partition defined as an external table, using the “gphdfs” protocol.  When a query’s date range includes endpoints spanning any of these time periods, the relevant data is automatically scanned.\n\nThis is the power available through table partitioning.",
                "data-partitioning-slide-9": "You can define a date range or a numeric range for a partitioned table:\n- A date range uses a single date or timestamp column as the partition key column.\n- When date partitioning a table, consider partitioning by the most granular level you are interested in. For example, partition by day and have 365 daily partitions, rather than partitioning by year, then subpartitioning by month, then subpartitioning by day.\n- You can have Greenplum automatically generate partitions by giving a START value, an END value, and an EVERY clause that defines the partition increment value.\nBy default, START values are always inclusive and END values are always exclusive.\nNote: You can declare and name each partition individually.",
                "data-partitioning-slide-10": "A numeric range uses a single numeric data type column as the partition key column\n\nCaveat: try to avoid using DEFAULT PARTITION\n- it is always scanned\n- in certain cases can contain far more data than expected",
                "data-partitioning-slide-12": "In our example here, we have included a default partition. While generally I would avoid using DEFAULT, for list partitioning it sometimes makes sense. Especially for staging tables or tables used for receiving external data. \nData is often messy and bad values may be in the partition field. Remember we can catch rows with bad data when we use COPY or gpfdist with EXTERNAL tables. But we would still need to interrogate the bad rows, fix the problem, and reload those rows. Alternatively, we could set up a DEFAULT PARTITION, load the data, and then filter and fix the data during the transformation into production tables.",
                "data-partitioning-slide-13": "It is not possible to partition a table that has already been created. Tables can only be partitioned at CREATE TABLE time.\nTo partition an existing table, you must:\n- Recreate the table as a partitioned table.\n- Load the data into the newly partitioned table.\n- Rename the new partitioned table to the original name and drop the original table.\n- Grant any table permissions to the new table that were granted on the original table.\n",
                "data-partitioning-slide-15": "Some partition information can be obtained by using the \\d+ PSQL meta-command. All child tables are displayed by their names. \n\nYou can obtain additional information from the pg_partitions view.\n\nThe pg_partition_columns view displays the column(s) used for partitioning.",
                "data-paritioning-slide-16": "With partitioned table structure, top-level parent tables are empty. Data is routed to the bottom-level child table partitions. COPY or INSERT automatically loads to the correct partition. Best practice for loading data into partitioned tables is to create an intermediate staging table, load it, and then exchange it into your partition table. You can exchange partitions only at the lowest level of your partition hierarchy. Rows that cannot be mapped to a child table partition are rejected and the load fails. \nTo avoid unmapped rows being rejected at load time, define your partition hierarchy with a DEFAULT partition. Any rows that do not match a partition’s CHECK constraints load into the DEFAULT partition.\nThe DEFAULT partition is always scanned and can slow down the overall scan time."
            }
        }
    };


    // Use local fonts
    SLConfig.fonts_url = 'lib/fonts/';
</script>

<script src="lib/reveal.min.js"></script>
<script src="lib/offline.js"></script>

<!-- Initialize the presentation -->
<script>
    Reveal.initialize({
        width: 960,
        height: 720,
        margin: 0.05,


        hash: true,
        controls: true,
        progress: true,
        mouseWheel: false,
        showNotes: false,
        slideNumber: false,

        autoSlide: 0,
        autoSlideStoppable: true,

        center: false,
        shuffle: false,
        loop: false,
        rtl: false,

        transition: "slide",
        backgroundTransition: "slide",

        highlight: {
            escapeHTML: false
        },
        /* Added menu plugin from https://github.com/denehyg/reveal.js-menu: CJS, 11oct2019 */
        /* For a description of the 'menu' options, see the gp-intro-overview.html presentation */
        menu: {
            side: 'left',
            width: 'wide',
            numbers: true,
            titleSelector: 'h1, h2, h3, h4, h5, h6',
            useTextContentForMissingTitles: false,
            hideMissingTitles: false,
            markers: true,
            custom: false,
            themes: false,
            themesPath: 'css/theme/',
            transitions: false,
            openButton: true,
            openSlideNumber: false,
            keyboard: true,
            sticky: false,
            autoOpen: true,
            delayInit: false,
            openOnInit: false,
            loadIcons: true
        },

        dependencies: [
            {
                src: 'lib/reveal-plugins/markdown/marked.js', condition: function () {
                    return !!document.querySelector('[data-markdown]');
                }
            },
            {
                src: 'lib/reveal-plugins/markdown/markdown.js', condition: function () {
                    return !!document.querySelector('[data-markdown]');
                }
            },
            {src: 'lib/reveal-plugins/highlight/highlight.js'},
            {
                src: 'lib/reveal-plugins/notes/notes.js', async: true, condition: function () {
                    return !!document.body.classList;
                }
            },
            {src: 'lib/reveal-plugins/zoom/zoom.js', async: true},
            {src: 'lib/reveal-plugins/menu/menu.js', async: false}
        ]
    });
</script>


</body>
</html>
